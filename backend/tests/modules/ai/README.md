# AI Pipeline Tests

–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã AI Pipeline –≤ –ø—Ä–æ–µ–∫—Ç–µ Go Flow.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/modules/ai/
‚îú‚îÄ‚îÄ unit/                    # Unit —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ base-operation.test.ts          # –¢–µ—Å—Ç—ã –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞ –æ–ø–µ—Ä–∞—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ operation-registry.test.ts      # –¢–µ—Å—Ç—ã —Ñ–∞–±—Ä–∏–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ simple-pipeline-engine.test.ts  # –¢–µ—Å—Ç—ã Pipeline Engine
‚îú‚îÄ‚îÄ integration/             # Integration —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ content-analysis-pipeline.test.ts  # –¢–µ—Å—Ç—ã –ø–æ–ª–Ω–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îú‚îÄ‚îÄ fixtures/               # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ test-data.ts        # Mock –¥–∞–Ω–Ω—ã–µ –∏ —É—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ jest.config.js          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Jest
‚îî‚îÄ‚îÄ README.md              # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í—Å–µ —Ç–µ—Å—Ç—ã AI Pipeline
```bash
cd backend
npm test -- tests/modules/ai
```

### –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
```bash
npm test -- tests/modules/ai/unit
```

### –¢–æ–ª—å–∫–æ integration —Ç–µ—Å—Ç—ã
```bash
npm test -- tests/modules/ai/integration
```

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
```bash
npm test -- tests/modules/ai/unit/base-operation.test.ts
```

### –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
```bash
npm test -- tests/modules/ai --coverage
```

### –í —Ä–µ–∂–∏–º–µ watch
```bash
npm test -- tests/modules/ai --watch
```

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

–¶–µ–ª–∏ –ø–æ–∫—Ä—ã—Ç–∏—è:
- **–í–µ—Ç–∫–∏ (Branches)**: 80%
- **–§—É–Ω–∫—Ü–∏–∏**: 80%
- **–°—Ç—Ä–æ–∫–∏**: 80%
- **–í—ã—Ä–∞–∂–µ–Ω–∏—è**: 80%

## üß™ –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

### Unit —Ç–µ—Å—Ç—ã

#### BaseOperation (`base-operation.test.ts`)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π (—É—Å–ø–µ—Ö –∏ –æ—à–∏–±–∫–∏)
- ‚úÖ –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å –º–Ω–æ–∂–∏—Ç–µ–ª—è–º–∏
- ‚úÖ –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

#### OperationRegistry (`operation-registry.test.ts`)
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –∏–∑ —Ñ–∞–±—Ä–∏–∫–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- ‚úÖ –ú–∞—Å—Å–æ–≤–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Ä–µ–µ—Å—Ç—Ä–∞

#### SimplePipelineEngine (`simple-pipeline-engine.test.ts`)
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ª–∏–Ω–µ–π–Ω—ã—Ö –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –£—Å–ª–æ–≤–Ω—ã–µ —à–∞–≥–∏
- ‚úÖ –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- ‚úÖ –ò–∑–º–µ—Ä–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### Integration —Ç–µ—Å—Ç—ã

#### Content Analysis Pipeline (`content-analysis-pipeline.test.ts`)
- ‚úÖ –ü–æ–ª–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Ç–∞–π–º–∞—É—Ç—ã
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
- ‚úÖ Edge cases (—Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã, unicode, –ø—É—Å—Ç–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç)

## üõ†Ô∏è –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

### TEST_CONTEXTS
–ü—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
- `basic` - –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `enterprise` - –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `business` - –±–∏–∑–Ω–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

### TEST_CONTENT
–†–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- `short` - –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç
- `medium` - —Å—Ä–µ–¥–Ω–∏–π —Ç–µ–∫—Å—Ç —Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
- `long` - –¥–ª–∏–Ω–Ω—ã–π —Å–ª–æ–∂–Ω—ã–π —Ç–µ–∫—Å—Ç
- `technical` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
- `emotional` - —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- `multilingual` - –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- `specialCharacters` - —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã –∏ —ç–º–æ–¥–∑–∏

### Mock –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ mock AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
- –û—à–∏–±–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ó–∞–¥–µ—Ä–∂–∫–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö
- –ö–∞—Å—Ç–æ–º–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

## üìã Utilities

### TestDataFactory
–§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
const context = TestDataFactory.createContext({
  userId: 'custom-user',
  priority: 'high'
});

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∑–∞–¥–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã
const content = TestDataFactory.createContent(1000); // 1000 —Å–∏–º–≤–æ–ª–æ–≤

// –°–æ–∑–¥–∞–Ω–∏–µ mock –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
const provider = TestDataFactory.createMockProvider({
  shouldFail: false,
  delay: 100
});
```

### TestAssertions
–ì–æ—Ç–æ–≤—ã–µ assertions –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏
TestAssertions.expectOperationResult(result);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞
TestAssertions.expectPipelineResult(result);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
TestAssertions.expectExecutionOrder(actual, expected);
```

## üîß –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –í–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
DEBUG=test npm test -- tests/modules/ai
```

### –ó–∞–ø—É—Å–∫ –æ–¥–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
```bash
npm test -- tests/modules/ai --testNamePattern="should execute simple linear pipeline"
```

### –ü—Ä–æ–ø—É—Å–∫ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
```bash
npm test -- tests/modules/ai --testPathIgnorePatterns=integration
```

## üö® Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –¢–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç —Å timeout
**–†–µ—à–µ–Ω–∏–µ**: –£–≤–µ–ª–∏—á—å—Ç–µ timeout –≤ `jest.config.js` –∏–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞:
```typescript
it('slow test', async () => {
  // —Ç–µ—Å—Ç
}, 60000); // 60 —Å–µ–∫—É–Ω–¥
```

### –ü—Ä–æ–±–ª–µ–º–∞: Mock –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ mock –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–æ –∏–º–ø–æ—Ä—Ç–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ–≥–æ –º–æ–¥—É–ª—è:
```typescript
jest.mock('../../../../src/modules/ai/providers/ai-provider.factory');
// –∑–∞—Ç–µ–º –∏–º–ø–æ—Ä—Ç—ã
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –≤ `collectCoverageFrom` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Jest.

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–û–∂–∏–¥–∞–µ–º—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

| –û–ø–µ—Ä–∞—Ü–∏—è | –ú–∞–∫—Å. –≤—Ä–µ–º—è | –ú–∞–∫—Å. —Å—Ç–æ–∏–º–æ—Å—Ç—å |
|----------|-------------|-----------------|
| Simple   | 1 —Å–µ–∫       | 2 –∫—Ä–µ–¥–∏—Ç–∞       |
| Medium   | 3 —Å–µ–∫       | 5 –∫—Ä–µ–¥–∏—Ç–æ–≤      |
| Complex  | 8 —Å–µ–∫       | 12 –∫—Ä–µ–¥–∏—Ç–æ–≤     |
| Heavy    | 15 —Å–µ–∫      | 25 –∫—Ä–µ–¥–∏—Ç–æ–≤     |

### –ü–∞–π–ø–ª–∞–π–Ω—ã
- **–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**: < 10 —Å–µ–∫, < 15 –∫—Ä–µ–¥–∏—Ç–æ–≤
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ 5 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞–π–ø–ª–∞–π–Ω–æ–≤

## üîÆ –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è —Ç–µ—Å—Ç–æ–≤

### –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- [ ] Stress —Ç–µ—Å—Ç—ã –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- [ ] –¢–µ—Å—Ç—ã –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ (failover)
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–∞–º—è—Ç–∏
- [ ] E2E —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ API endpoints
- [ ] –¢–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (injection, validation)

### –ü–ª–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ PR
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD pipeline
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–Ω–∞–ø—à–æ—Ç–æ–≤
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞:** ${new Date().toISOString().split('T')[0]}
**–í–µ—Ä—Å–∏—è —Ç–µ—Å—Ç–æ–≤:** 1.0.0 