# Обновления клиента для новой системы авторизации

## Изменения в системе авторизации

Backend теперь использует систему с access и refresh токенами для улучшенной безопасности.

### Основные изменения:

1. **Два типа токенов**:

   - **Access Token** - короткоживущий (15 минут), используется для API запросов
   - **Refresh Token** - долгоживущий (30 дней), используется для обновления access токена

2. **Автоматическое обновление токенов**:

   - API сервис автоматически обновляет access токен при получении 401 ошибки
   - Повторяет запрос с новым токеном без вмешательства пользователя

3. **Изменения в Google OAuth callback**:
   - Теперь возвращаются два параметра: `accessToken` и `refreshToken`
   - Оба токена сохраняются в localStorage

## Что было обновлено:

### 1. `/app/src/app/auth/google/callback/page.tsx`

- Обработка двух токенов вместо одного
- Сохранение refresh токена в localStorage

### 2. `/app/src/services/api.ts`

- Добавлен метод `refreshAccessToken()` для обновления токена
- Добавлен метод `fetchWithAuth()` который автоматически обрабатывает 401 ошибки
- Все API методы теперь используют `fetchWithAuth()`

## Как это работает:

1. При входе через Google пользователь получает оба токена
2. Access токен используется для всех API запросов
3. Когда access токен истекает (через 15 минут), API автоматически:
   - Использует refresh токен для получения нового access токена
   - Повторяет оригинальный запрос с новым токеном
4. Если refresh токен недействителен, пользователь перенаправляется на страницу входа

## Преимущества:

- **Безопасность**: Короткоживущие access токены минимизируют риски
- **Удобство**: Автоматическое обновление токенов без участия пользователя
- **Надежность**: Повторная попытка запросов при истечении токена

## Для разработчиков:

Никаких изменений в использовании API сервиса не требуется. Все методы работают как раньше:

```typescript
// Пример использования
const projects = await api.getProjects();
const newProject = await api.createProject({name: 'New Project'});
```

Обработка токенов происходит автоматически внутри API сервиса.
